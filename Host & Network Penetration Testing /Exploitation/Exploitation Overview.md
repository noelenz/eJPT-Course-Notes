# Introduction

## Penetration Testing Phases

![grafik](https://github.com/user-attachments/assets/5d6c25a9-9920-4011-a243-fdfa17c5659b)

**Exploitation Methodology:**
- Identify Vulnerable Services
- Identify & Prepare Exploit Code
- Gaining Access
  - Automated - MSF
  - Manual
- Obtain remote access on target system.
- Bypass AV detection
- Pivot on to other systems

# Vulnerability Scanning

## Banner Grabbing

- Banner grabbing is an information gathering technique used by pentesters to enumerate information regarding the target operating system as well as the services that are running on its open ports.
- The primary objective of banner grabbing is to identify the service running on a specific port as well as the service version.
- Banner grabbing can be peformed through various techniques:
  - Performing a service version detection scan with Nmap.
  - Connecting to the open port with Netcat.
  - Authenticating with the service (If the service supports authentication), for example, SSH, FTP, Telnet etc.
 
## Demo: Banner Grabbing

`ls -al /usr/share/nmap/scripts/ | pgrep banner`

`nmap -sV --script=banner demo.ine.local`


#### Banner Grabbing with Netcat

`man nc`

`nc demo.ine.local 22`

`searchsploit openssh 7.2`

`ssh root@demo.ine.local`: gives us the ssh welcome banner. Could give us useful information.

## Vulnerability Scanning with Nmap Scripts

**nmap.org**
# Vulnerability Scanning with Nmap Scripts

## Overview

## Demo: Vulnerability Scanning with Nmap Scripts

### Step-by-Step Process

Perform a basic Nmap service and OS detection scan on the target:

```bash
nmap -sV -O demo.ine.local
```

### Vulnerability Detection Scans

Nmap scripts are stored in the following directory:

```bash
ls -al /usr/share/nmap/scripts/
```

To limit the results and search for scripts related to HTTP:

```bash
ls -al /usr/share/nmap/scripts/ | grep http
```

Run an Nmap scan with the **http-enum** script, which enumerates common web application files and directories:

```bash
nmap -sV -p 80 --script=http-enum demo.ine.local
```

### Finding Exploits with Searchsploit

Search for available exploits related to **Apache 2.4.6** using **Searchsploit**:

```bash
searchsploit apache 2.4.6
```

### Creating / Editing a Nmap Script

You can create or edit an existing Nmap script using a text editor such as `nano`. For example, to edit the **http-enum** script:

```bash
nano /usr/share/nmap/scripts/http-enum.nse
```

### Utilizing Nmap Scripts for Specific Services

To list vulnerability detection scripts, use the following command:

```bash
ls -al /usr/share/nmap/scripts/ | grep vuln
```

We want to check if the target is vulnerable to the **shellshock** vulnerability. First, list the relevant scripts:

```bash
ls -al /usr/share/nmap/scripts/ | grep shellshock
```

Run an Nmap scan with the **http-shellshock** script on port 80:

```bash
nmap -sV -p 80 --script=http-shellshock demo.ine.local
```

### Analyzing a Web Application Vulnerability

We check the website and the source code and discover that it runs a script for a **dynamic timer**. We try to access the **gettime.cgi** script on the target:

```bash
http://demo.ine.local/gettime.cgi
```

Now, we check if the **gettime.cgi** file is vulnerable to the **shellshock** vulnerability by running the **http-shellshock** script with additional arguments:

```bash
nmap -sV -p 80 --script=http-shellshock --script-args "http-shellshock.uri=/gettime.cgi" demo.ine.local
```

### Conclusion

What we accomplished:
- Ran a basic **Nmap scan** to detect services and the OS on the target.
- Explored where **Nmap scripts** are stored and how to filter and use specific scripts.
- Used the **http-enum** script to enumerate directories on a web server.
- Performed a **shellshock** vulnerability scan on the target by utilizing Nmap scripts.
- Analyzed a potential **web application vulnerability** by interacting with the web server and targeting specific scripts.

This demonstrates how to use Nmap's scripting engine for vulnerability scanning and how to customize and utilize specific scripts to find vulnerabilities in web applications.


Note: `ls al /usr/share/nmap/Scripts/ | grep ftp` to look for ftp scripts




