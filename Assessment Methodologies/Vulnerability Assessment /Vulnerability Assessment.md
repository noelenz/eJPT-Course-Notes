# Course Topic Overview
- Vulnerabilities
- Case Studies
  - Heartbleed
  - EternalBlue
  - Log4J
- Labs
  - Nessus
  - ExploitDB
 
# Vulnerabilities
  
NIST definition:
A weakness in the computational logic (e.g., code) found in software and hardware components that, when exploited, results in a negative impact to confidentality, integrity or availability.

# Nessus Lab
In this lab we will use Nessus to scan and perform vulnerability analysis of a target machine running an instance of Mutillidae web application.

This exercise will help to understand how to perform vulnerability scanning using Nessus.

## Relevant Information:
- username: admin
- password: adminpasswd

## Tools:
- Nessus
- web browser

### Performing vulnerability scan on the target machine using Nessus.

In the browser we type in: https://localhost:8834

Then we login with our above credentials.

Now we scan the target machine using Nessus:

![grafik](https://github.com/user-attachments/assets/ec1a754d-dbfe-4ed1-9812-a9316ce38612)

In this particular scan, 2 medium severity vulnerabilities were discovered. To get more details about the vulnerabilities, we click on the horizontal colored bar containing the vulnerabilities of different severity and their respective counts.

To get more info about a vulnerability, we can click on it:

![grafik](https://github.com/user-attachments/assets/695b9bd7-fdca-4bb2-82a1-aaa57e1f1cc1)

This page shows us the vulnerability name, it's severity, a short description, a remediation strategy, related advisories/links.

The output section on the same page might show us the steps or the URL to exploit or confirm the vulnerability as well:

![grafik](https://github.com/user-attachments/assets/bb57e601-c95e-4bfd-be95-9881d5d53a05)

### Download the vulnerabilities report for the basic network scan

On the top right corner, we can download our Vulnerability scan in form of a report:

![grafik](https://github.com/user-attachments/assets/4bd38c3e-5c06-4cb6-aab8-e8e04cece3a1)

### Performing a custom scan using Nessus.

We want to create a custom Scan using "Advanced Scan" under the category "My Scans".
We filled in our credentials, and after that we changed the "Discovery" "Host Discovery" settings:

![grafik](https://github.com/user-attachments/assets/39f109c8-10cb-4989-992d-65a3fed721e5)

Now we change the DISCOVERY -> Port Scanning settings
Here we check the TCP box to perform a more accurate scan

Under "GENERAL" we check the Perform thorough tests (may disrupt our network or impact scan speed) option:

![grafik](https://github.com/user-attachments/assets/2addcbb8-2551-479a-a96e-e2fefa253587)

Under "WEB APPLICATIONS" we want our scan to perform a web application scan:

![grafik](https://github.com/user-attachments/assets/14cd8d5e-b912-4d4d-bd8e-fdbea9ae5002)

### Run the configured scan:

![grafik](https://github.com/user-attachments/assets/6a06f4d7-dc62-4303-b0da-9ef95c5529c4)

We can see our Vulnerabilities: 

![grafik](https://github.com/user-attachments/assets/814b90c2-0276-4973-acf1-45b2609614de)

We enumerated a URL:

![grafik](https://github.com/user-attachments/assets/d91611bc-ed42-40bf-973f-39fb8373f08e)

We also check out another interesting vulnerability:

![grafik](https://github.com/user-attachments/assets/4c6c8089-94f9-46d2-bbbb-a235ebc419c1)

This git repository actually exists:

![grafik](https://github.com/user-attachments/assets/c2572f7c-b0ba-4f94-961d-de331e43d877)

We also could export this Scan in form of a report.

# Vulnerability Assessment

## Types of Windows Vulnerabilities 

- **Infomation disclosure** - Vulnerability that allows an attacker to access confidental data
- **Buffer overflows** - Caused by a programming error, allows attackers to write data to a buffer and overrun the allocated buffer, consequently writing data to acllocated memory addresses.
- **Remote code execution** - Vulnerability that allows an attacker to remotely execute code on the target system.
- **Privilege escalation** - Vulnerability that allows an attacker to elevate their privileges after initial compromise.
- **Denial of Service (DOS)** - Vulnerability that allows an attacker to consume a system/host's resources (CPU, RAM, Network etc.) consequently preventing the system from functioning normally.

## Frequently Exploited Windows Services

![grafik](https://github.com/user-attachments/assets/43fa123c-015d-4a4a-a1c0-17ed761ef42c)

## Web App Vulnerability Scanning with WMAP

- WMAP is a web application vulnerability scanner that can be used to automate web server enumeration and scan web applications for vulnerabilites.
- WMAP is available as an MSF plugin and can be loaded directly into MSF.
- WMAP is fully integrated with MSF, which consequently allows us to perform web app vulnerability scanning from withtin the MSF.

# Web App Vulnerability Scanning with WMAP

## Overview

- **WMAP**: A web application vulnerability scanner built into Metasploit, used to discover vulnerabilities in web applications such as SQL injection, file upload vulnerabilities, or directory traversal.
- **Goal**: This demo will guide you through the process of scanning a target web application for vulnerabilities using WMAP in Metasploit.

## Demo: Web App Vulnerability Scanning with WMAP

### Step-by-Step Process

Check network configuration:

```bash
ifconfig
```

Start PostgreSQL service:

```bash
service postgresql start
```

Create a new workspace for **WMAP Scanning**:

```bash
workspace -a WMAP_Scanning
```

Set the target IP address globally:

```bash
setg rhosts demo.ine.local
```

### Loading WMAP

Load the **WMAP** module:

```bash
load wmap
```

List available **WMAP** commands:

```bash
wmap_[TAB]
```

### Adding a Target Site

To add a website to scan, use the following command:

```bash
wmap_sites -a demo.ine.local
```

### Setting Target Directories for Scanning

List available **WMAP target** options:

```bash
wmap_targets -h
```

Set the web application directory that you want to scan (replace `[directory]` with the actual directory path):

```bash
wmap_targets -t http://demo.ine.local/[directory]
```

List the added sites:

```bash
wmap_sites -l
```

List the added targets:

```bash
wmap_targets -l
```

### Running the WMAP Scan

Show available **WMAP run** options:

```bash
wmap_run -h
```

Run the scan for the specified target:

```bash
wmap_run -t
```

Run an **extended** scan (if necessary):

```bash
wmap_run -e
```

### Reviewing Vulnerabilities

Once the scan is complete, list the discovered vulnerabilities:

```bash
wmap_vulns -l
```

### Testing Specific Web Server Directories

We can test specific directories on the web server for vulnerabilities. For example, testing for HTTP PUT (a file upload vulnerability):

Use the **HTTP PUT** auxiliary module:

```bash
use auxiliary/scanner/http/http_put
```

Show the available options:

```bash
show options
```

Run the module with a specific path (in this case `/Data/`):

```bash
set path /Data/
run
```

### Uploading a File via HTTP PUT

You can configure the module to upload a file with reverse connection capabilities.

To test if the file was uploaded successfully, use **curl**:

```bash
curl http://demo.ine.local:80/data/msf_http_put_test.txt
```

### Setting Custom File Data for Upload

You can set custom file data and upload a file to the target:

```bash
set filedata "This does work"
set filename this_works.txt
run
```

Test if the file was uploaded successfully by accessing it via **curl**:

```bash
curl path/to/file
```

### Conclusion

What we accomplished:
- Configured and scanned a web application using **WMAP** in Metasploit.
- Added specific web directories for scanning.
- Discovered vulnerabilities through WMAP scans and tested specific HTTP methods like **HTTP PUT** to upload files.
- Successfully uploaded files to the target server and verified them using **curl**.

This demo demonstrates the capabilities of **WMAP** as a web vulnerability scanner and how to perform in-depth testing of web application directories using Metasploit.





















